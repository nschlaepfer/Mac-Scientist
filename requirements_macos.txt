# requirements_macos.txt - Apple Silicon (M1/M2/M3) optimized dependencies
# Tested on M3 Max with 128GB unified memory
# Install with: pip install -r requirements_macos.txt

# ============================================
# Core ML Frameworks for Apple Silicon
# ============================================

# PyTorch with MPS (Metal Performance Shaders) support
# Install from default PyPI - includes MPS backend for Apple Silicon
# Do NOT use --extra-index-url for cpu wheels as that drops MPS support
torch>=2.2.0

# MLX - Apple's native ML framework (fastest on Apple Silicon)
mlx>=0.22.0
mlx-lm>=0.21.0

# Transformers with Metal optimizations
transformers>=4.40.0
tokenizers>=0.19.0

# ============================================
# Inference Servers (choose one)
# ============================================

# Option 1: llama.cpp with Metal support (recommended for speed)
# Install separately: CMAKE_ARGS="-DLLAMA_METAL=on" pip install llama-cpp-python
# llama-cpp-python>=0.2.90

# Option 2: MLX-LM server (native Apple Silicon, included above)

# ============================================
# Required Dependencies
# ============================================

# Configuration and data
hydra-core>=1.3.0
omegaconf>=2.3.0
pydantic>=2.0.0

# Data handling
datasets>=2.18.0
pandas>=2.0.0
numpy>=1.24.0,<2.0.0
pyarrow>=15.0.0

# API and networking
httpx[http2]>=0.27.0
requests>=2.31.0
aiohttp>=3.9.0

# Web server
fastapi>=0.110.0
uvicorn[standard]>=0.29.0

# UI
gradio>=4.25.0

# Environment and utilities
python-dotenv>=1.0.0
colorlog>=6.8.0
pyyaml>=6.0.0
tqdm>=4.66.0

# Tokenization and text processing
tiktoken>=0.6.0
sentencepiece>=0.2.0

# Async support
anyio>=4.3.0
asyncio-throttle>=1.0.0

# ============================================
# Optional: Enhanced Performance
# ============================================

# Accelerate for optimized inference
accelerate>=0.28.0

# Memory optimization
bitsandbytes>=0.43.0;platform_system!="Darwin"  # Not needed for MPS

# ============================================
# Development Dependencies (optional)
# ============================================

# pre-commit
# pytest
# black
# ruff

